# 選舉資料處理系統

將中央選舉委員會（CEC）原始選舉資料轉換為統一的鄰里層級格式。

## 支援年份與選舉類型

### 地方公職選舉（2014、2018、2022）
- 縣市長 / 直轄市長
- 縣市議員（區域/平原/山原）/ 直轄市議員
- 鄉鎮市長
- 鄉鎮市民代表

### 總統立委選舉（2016、2020、2024）
- 總統
- 立法委員（區域/平地/山地）
- 不分區政黨

## 快速開始

```bash
# 安裝依賴
pip install pandas numpy

# 執行處理
python main.py
```

## 資料夾結構

```
CEC_data_clearn_and_combine/
├── voteData/                    # 原始 CEC 選舉資料
│   ├── 2014-103年地方公職人員選舉/
│   ├── 2016總統立委/
│   ├── 2018-107年地方公職人員選舉/
│   ├── 2020總統立委/
│   ├── 2022-111年地方公職人員選舉/
│   └── 2024總統立委/
├── 鄰里整理輸出/                # 處理後輸出
│   ├── 花蓮縣/
│   │   ├── 2014_選舉資料_花蓮縣.csv
│   │   ├── 2016_選舉資料_花蓮縣.csv
│   │   └── ...
│   └── 臺北市/
│       └── ...
├── main.py                      # 主程式
├── 鄰里整理範例 - 2014.csv      # 輸出格式範例（地方選舉）
└── 鄰里整理範例 - 2020.csv      # 輸出格式範例（總統選舉）
```

## 輸出格式

### 地方公職選舉（2014/2018/2022）

| 欄位 | 說明 |
|------|------|
| 縣市 | 縣市名稱 |
| 行政區別 | 鄉鎮市區名稱 |
| 鄰里 | 村里名稱 |
| 區域別代碼 | 選區代碼 |
| 縣市長候選人N＿候選人名稱 | 候選人姓名 |
| 縣市長候選人N＿黨籍 | 政黨 |
| 縣市長候選人N_得票數 | 得票數 |
| 縣市長有效票數A | 有效票數 |
| ... | 其他選舉類型欄位 |

### 總統立委選舉（2016/2020/2024）

| 欄位 | 說明 |
|------|------|
| 縣市 | 縣市名稱 |
| 行政區別 | 鄉鎮市區名稱 |
| 鄰里 | 村里名稱 |
| 區域別代碼 | 選區代碼 |
| 總統候選人N | 候選人姓名（正/副總統） |
| 總統候選人N_得票數 | 得票數 |
| 區域立委候選人N＿黨籍 | 政黨 |
| 區域立委候選人N_得票數 | 得票數 |
| 不分區政黨(N)\n\n政黨名 | 政黨得票數 |
| ... | 其他統計欄位 |

## 支援縣市

目前已設定：
- 花蓮縣 (prv_code=10, city_code=15)
- 臺北市 (prv_code=63, city_code=0, 直轄市)

可在 `main.py` 中的 `COUNTY_CONFIG` 新增其他縣市。

## 輸出驗證

程式會自動驗證輸出：
- 無重複鄰里（行政區別 + 鄰里 組合唯一）
- 資料完整性檢查

## 使用範例

```python
import pandas as pd

# 讀取處理後的資料
df_2020 = pd.read_csv('鄰里整理輸出/花蓮縣/2020_選舉資料_花蓮縣.csv')

# 查看總統候選人得票
print(df_2020[['行政區別', '鄰里', '總統候選人1', '總統候選人1_得票數']].head())

# 統計各候選人總得票
for i in range(1, 4):
    col = f'總統候選人{i}_得票數'
    if col in df_2020.columns:
        total = df_2020[col].sum()
        name = df_2020[f'總統候選人{i}'].iloc[0]
        print(f'{name}: {total:,} 票')
```

## 技術特點

- 自動處理多種 CSV 編碼（UTF-8, Big5, CP950）
- 自動正規化行政區名稱（移除縣市前綴和選區標記）
- 智慧資料合併（outer join + 重複處理）
- 2022 年特殊資料夾結構支援（T1/C1/R1 代碼）

## 授權

本專案為開源專案，資料來源為中華民國中央選舉委員會公開資料。

---

**最後更新**：2025-12-13
**支援年份**：2014-2024
